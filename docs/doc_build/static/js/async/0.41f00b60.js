"use strict";(self.webpackChunk_mini_markdown_resin_docs=self.webpackChunk_mini_markdown_resin_docs||[]).push([["0"],{8282:function(n,e,r){r.r(e),r.d(e,{default:()=>d});var s=r(651),t=r(6971),a=r(6755);function l(n){let e=Object.assign({h1:"h1",a:"a",p:"p",code:"code",h2:"h2",h3:"h3",ul:"ul",li:"li",strong:"strong",pre:"pre",details:"details",summary:"summary",div:"div",blockquote:"blockquote"},(0,t.ah)(),n.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.h1,{id:"ast-解析",children:["AST 解析",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#ast-解析",children:"#"})]}),"\n",(0,s.jsxs)(e.p,{children:["一个 Markdown 编辑器的 AST 解析器，支持 ",(0,s.jsx)(e.code,{children:"ESM"})," 和 ",(0,s.jsx)(e.code,{children:"CommonJS"})," 两个格式，也支持增量构建。"]}),"\n",(0,s.jsxs)(e.h2,{id:"安装",children:["安装",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#安装",children:"#"})]}),"\n",(0,s.jsx)(a.SU,{command:"install @mini-markdown-rc/ast-parser"}),"\n",(0,s.jsxs)(e.h2,{id:"api",children:["API",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#api",children:"#"})]}),"\n",(0,s.jsxs)(e.h3,{id:"parsemarkdown",children:["parseMarkdown",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#parsemarkdown",children:"#"})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["参数：",(0,s.jsx)(e.code,{children:"markdown: string, options?: IncrementalParseOptions"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"markdown"}),"：markdown 内容"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"options"}),"：可选参数","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"prevMarkdown"}),"上次解析的 markdown 内容"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"prevRoot"}),"：上次解析的 ast 对象，用于增量构建"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["返回值：",(0,s.jsx)(e.code,{children:"RootTokens"}),"，解析的 ast 对象"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"用于解析 markdown 文本，返回一个 ast 对象。"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"基本使用："})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:'import { parseMarkdown } from "@mini-markdown-rc/ast-parser";\r\n\r\nconst ast = parseMarkdown("# Hello World");\n'})}),"\n",(0,s.jsxs)(e.details,{className:"rspress-directive details",children:[(0,s.jsx)(e.summary,{className:"rspress-directive-title",children:"解析后的内容"}),(0,s.jsxs)(e.div,{className:"rspress-directive-content",children:["\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'{\r\n  "type": "root",\r\n  "children": [\r\n    {\r\n      "type": "heading",\r\n      "depth": 1,\r\n      "children": [\r\n        {\r\n          "type": "text",\r\n          "value": "Hello World",\r\n          "position": {\r\n            "start": {\r\n              "line": 1,\r\n              "column": 1,\r\n              "offset": 0\r\n            },\r\n            "end": {\r\n              "line": 1,\r\n              "column": 12,\r\n              "offset": 11\r\n            }\r\n          }\r\n        }\r\n      ],\r\n      "position": {\r\n        "start": {\r\n          "line": 1,\r\n          "column": 1,\r\n          "offset": 0\r\n        },\r\n        "end": {\r\n          "line": 1,\r\n          "column": 14,\r\n          "offset": 13\r\n        }\r\n      }\r\n    }\r\n  ],\r\n  "position": {\r\n    "start": {\r\n      "line": 1,\r\n      "column": 1,\r\n      "offset": 0\r\n    },\r\n    "end": {\r\n      "line": 1,\r\n      "column": 1,\r\n      "offset": 13\r\n    }\r\n  }\r\n}\n'})}),"\n"]})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"增量构建："})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:'import { parseMarkdown } from "@mini-markdown-rc/ast-parser";\r\n\r\n// 模拟上一次解析的 markdown 内容和 ast 对象\r\nconst lastCode = "#Hello World";\r\nconst lastAst =\r\n  \'{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Hello World","position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":12,"offset":11}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":14,"offset":13}}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":1,"column":1,"offset":13}}}\';\r\n\r\nconst ast = parseMarkdown("# Hello World, this is a test", {\r\n  prevMarkdown: lastCode,\r\n  prevRoot: JSON.parse(lastAst),\r\n});\n'})}),"\n",(0,s.jsxs)(e.h3,{id:"transformhtml",children:["transformHtml",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#transformhtml",children:"#"})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["参数：",(0,s.jsx)(e.code,{children:"ast: RootTokens"})]}),"\n",(0,s.jsxs)(e.li,{children:["返回值：",(0,s.jsx)(e.code,{children:"string"}),"，转换后的 html 字符串"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"用于将 ast 对象转换为 html 字符串。"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:'import { parseMarkdown, transformHtml } from "@mini-markdown-rc/ast-parser";\r\n\r\nconst ast = parseMarkdown("# Hello World");\r\nconst html = transformHtml(ast);\r\n\r\n// 输出的内容：<h1 class="mini-md-h1" data-line="1">Hello World</h1>\r\nconsole.log(html);\n'})}),"\n",(0,s.jsxs)(e.div,{className:"rspress-directive tip",children:[(0,s.jsx)(e.div,{className:"rspress-directive-title",children:"注意"}),(0,s.jsxs)(e.div,{className:"rspress-directive-content",children:["\n",(0,s.jsxs)(e.p,{children:["解析后，在 html 中，添加了 ",(0,s.jsx)(e.code,{children:"data-line"})," 属性，用于标识行号。同时对于一些特殊节点，也添加了 ",(0,s.jsx)(e.code,{children:"class"})," 属性，用于处理样式。"]}),"\n",(0,s.jsxs)(e.p,{children:["该包中也导出了前缀常量",(0,s.jsx)(e.code,{children:"prefix"}),"，值为：",(0,s.jsx)(e.code,{children:"mini-md"}),"。"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:'import { prefix } from "@mini-markdown-rc/ast-parser";\n'})}),"\n"]})]}),"\n",(0,s.jsxs)(e.h2,{id:"不同环境下使用",children:["不同环境下使用",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#不同环境下使用",children:"#"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'// esm\r\nimport { parseMarkdown, transformHtml } from "@mini-markdown-rc/ast-parser";\r\n// commonjs\r\nconst { parseMarkdown, transformHtml } = require("@mini-markdown-rc/ast-parser");\n'})}),"\n",(0,s.jsxs)(e.h2,{id:"样式",children:["样式",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#样式",children:"#"})]}),"\n",(0,s.jsx)(e.p,{children:"该库导出了一个默认样式文件，用于渲染转换后的html样式。"}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"对于代码块的样式，需要手动引入样式文件。"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:'import "highlight.js/styles/atom-one-dark.css";'})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:"import '@mini-markdown-rc/ast-parser/style/index.css'\n"})}),"\n",(0,s.jsxs)(e.h2,{id:"案例",children:["案例",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#案例",children:"#"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-js",children:'// 读取 markdown 文件\r\nconst code = fs.readFileSync(path.resolve(__dirname, "./demo.md"), "utf-8");\r\n// 解析 markdown 内容为 ast 对象\r\nconst ast = parseMarkdown(code);\r\n// 转换 ast 为 html 字符串\r\nconst html = transformHtml(ast);\r\n// 插入样式\r\nconst newHtml = `<link rel="stylesheet" href="./demo.css">` + html;\r\n// highlight.js 样式文件（对 代码块 着色）\r\nconst node_modulesCSSPath = path.resolve(\r\n  __dirname,\r\n  "../node_modules/highlight.js/styles/atom-one-dark.min.css",\r\n);\r\nconst node_modulesCSS = fs.readFileSync(node_modulesCSSPath, "utf-8");\r\n\r\nconst indexHtml = `\r\n  <!DOCTYPE html>\r\n  <html lang="en">\r\n  <head>\r\n    <meta charset="UTF-8">\r\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\r\n    <title>Document</title>\r\n    <style>${node_modulesCSS}</style>\r\n  </head>\r\n  <body>\r\n    ${newHtml}\r\n  </body>\r\n  </html>\r\n`;\r\n\r\nfs.writeFileSync(path.resolve(__dirname, "./index.html"), indexHtml);\r\nconsole.log("index.html 生成成功\\npath:", path.resolve(__dirname, "./index.html"));\n'})}),"\n",(0,s.jsxs)(e.h2,{id:"类型",children:["类型",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#类型",children:"#"})]}),"\n",(0,s.jsxs)(e.h3,{id:"tokens_types",children:["TOKENS_TYPES",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#tokens_types",children:"#"})]}),"\n",(0,s.jsx)(e.p,{children:"分词常量。"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:'// 定义 Tokens 分词类型：区分当前是什么类型的节点\r\nexport const TOKENS_TYPES = {\r\n  // 块级\r\n  Heading: "heading", // 标题\r\n  Paragraph: "paragraph", // 段落\r\n  Blockquote: "blockquote", // 引用\r\n  ThematicBreak: "thematicBreak", // 分割线\r\n  // 行级\r\n  Text: "text", // 文本\r\n  Bold: "bold", // 加粗\r\n  Italic: "italic", // 斜体\r\n  Underline: "underline", // 下划线\r\n  Delete: "delete", // 删除线\r\n  Link: "link", // 链接\r\n  Image: "image", // 图片\r\n  InlineCode: "inlineCode", // 行内高亮\r\n  // 其他\r\n  Code: "code", // 代码块\r\n  List: "list", // 列表\r\n  ListItem: "listItem", // 列表项\r\n  Html: "html", // html 标签\r\n  Table: "table", // 表格\r\n  TableRow: "tableRow", // 表格行\r\n  TableCell: "tableCell", // 表格单元格\r\n} as const;\n'})}),"\n",(0,s.jsxs)(e.h3,{id:"tokens",children:["Tokens",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#tokens",children:"#"})]}),"\n",(0,s.jsx)(e.p,{children:"每个节点的类型。"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:"type PositionType = {\r\n  start: {\r\n    line: number;\r\n    column: number;\r\n    offset: number;\r\n  };\r\n  end: {\r\n    line: number;\r\n    column: number;\r\n    offset: number;\r\n  };\r\n};\r\n\r\nexport interface Tokens {\r\n  type: TokenTypeVal;\r\n  value?: string; // 节点的值\r\n  /**\r\n   * 只对 heading 有效\r\n   */\r\n  depth?: number; // 标题的层级\r\n  /**\r\n   * 只对 list 有效\r\n   */\r\n  ordered?: boolean; // 是否有序\r\n  /**\r\n   * 只对 image、link 有效\r\n   * （注意：link 没有 alt 属性）\r\n   */\r\n  title?: string | null; // 图片、链接的标题\r\n  url?: string; // 图片、链接的链接\r\n  alt?: string; // 图片的alt\r\n  /**\r\n   * 只对 code 有效\r\n   */\r\n  lang?: string; // 代码块的lang\r\n  meta?: string | null; // 代码块的meta(```js [meta])\r\n  children?: Tokens[];\r\n  position: PositionType;\r\n}\n"})}),"\n",(0,s.jsxs)(e.h3,{id:"roottokens",children:["RootTokens",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#roottokens",children:"#"})]}),"\n",(0,s.jsx)(e.p,{children:"根节点类型。"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:'export interface RootTokens {\r\n  type: "root";\r\n  children: Tokens[];\r\n  position: PositionType;\r\n}\n'})}),"\n",(0,s.jsxs)(e.h3,{id:"tokens的-keyvalue-类型",children:["Tokens的 Key、Value 类型",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#tokens的-keyvalue-类型",children:"#"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:'// 导出分词类型（也就是区分当前是什么类型的节点）\r\nexport type TokensTypes = Record<keyof typeof TOKENS_TYPES, TokenTypeVal>;\r\n// 分词类型的 key\r\nexport type TokensTypesKey = keyof TokensTypes;\r\n// 分词类型的 value\r\n/**\r\n * type TokenTypeVal =\r\n  | "bold"\r\n  | "link"\r\n  | "heading"\r\n  | "paragraph"\r\n  | "blockquote"\r\n  | "thematicBreak"\r\n  | "text"\r\n  | "italic"\r\n  | "underline"\r\n  | "delete"\r\n  | "image"\r\n  | "inlineCode"\r\n  | "code"\r\n  | "list"\r\n  | "listItem"\r\n  | "html"\r\n  | "table"\r\n  | "tableRow"\r\n  | "tableCell";\r\n */\r\nexport type TokenTypeVal = (typeof TOKENS_TYPES)[keyof typeof TOKENS_TYPES];\n'})}),"\n",(0,s.jsxs)(e.h3,{id:"incrementalparseoptions",children:["IncrementalParseOptions",(0,s.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#incrementalparseoptions",children:"#"})]}),"\n",(0,s.jsx)(e.p,{children:"增量构建配置项类型。"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:"export interface IncrementalParseOptions {\r\n  prevMarkdown?: string;\r\n  prevRoot?: RootTokens;\r\n}\n"})})]})}function i(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,t.ah)(),n.components);return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(l,{...n})}):l(n)}let d=i;i.__RSPRESS_PAGE_META={},i.__RSPRESS_PAGE_META["guide%2Fast-parser.mdx"]={toc:[{text:"安装",id:"安装",depth:2},{text:"API",id:"api",depth:2},{text:"parseMarkdown",id:"parsemarkdown",depth:3},{text:"transformHtml",id:"transformhtml",depth:3},{text:"不同环境下使用",id:"不同环境下使用",depth:2},{text:"样式",id:"样式",depth:2},{text:"案例",id:"案例",depth:2},{text:"类型",id:"类型",depth:2},{text:"TOKENS_TYPES",id:"tokens_types",depth:3},{text:"Tokens",id:"tokens",depth:3},{text:"RootTokens",id:"roottokens",depth:3},{text:"Tokens的 Key、Value 类型",id:"tokens的-keyvalue-类型",depth:3},{text:"IncrementalParseOptions",id:"incrementalparseoptions",depth:3}],title:"AST 解析",headingTitle:"AST 解析",frontmatter:{}}}}]);